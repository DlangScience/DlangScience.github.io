<!DOCTYPE html><html><head>
<meta charset="UTF-8"/>
<title>Function bracketRoot</title>
<link rel="stylesheet" type="text/css" href="../../styles/ddox.css"/>
<link rel="stylesheet" href="../../prettify/prettify.css" type="text/css"/>
<script type="text/javascript" src="../../scripts/jquery.js">/**/</script><script type="text/javascript" src="../../scripts/ddox.js">/**/</script></head><body onload="setupDdox();"><nav id="main-nav"><noscript><p style="color: red">The search functionality needs JavaScript enabled</p></noscript><div id="symbolSearchPane" style="display: none"><form action="#" method="GET">
<input id="symbolSearch" type="text" name="q" placeholder="Search for symbols" autocomplete="off" onchange="performSymbolSearch(40);" onkeypress="this.onchange();" onpaste="this.onchange();" oninput="this.onchange();"/></form><ul id="symbolSearchResults" class="symbolList" style="display: none"></ul><script type="application/javascript" src="../../symbols.js"></script><script type="application/javascript">var symbolSearchRootDir = "../../";
$('#symbolSearchPane').show();</script></div><ul class="tree-view"><li class="tree-view "><div class="package ">scid</div><ul class="tree-view"><li class="tree-view collapsed"><div class="package ">bindings</div><ul class="tree-view"><li class="tree-view collapsed"><div class="package ">lapack</div><ul class="tree-view"><li><div class="module "><a href="../../scid/bindings/lapack/dlapack.html">dlapack</a></div></li><li><div class="module "><a href="../../scid/bindings/lapack/lapack.html">lapack</a></div></li></ul></li></ul></li><li class="tree-view collapsed"><div class="package ">core</div><ul class="tree-view"><li><div class="module "><a href="../../scid/core/fortran.html">fortran</a></div></li><li><div class="module "><a href="../../scid/core/memory.html">memory</a></div></li><li><div class="module "><a href="../../scid/core/meta.html">meta</a></div></li><li><div class="module "><a href="../../scid/core/testing.html">testing</a></div></li><li><div class="module "><a href="../../scid/core/traits.html">traits</a></div></li></ul></li><li class="tree-view collapsed"><div class="package ">internal</div><ul class="tree-view"><li class="tree-view collapsed"><div class="package ">calculus</div><ul class="tree-view"><li><div class="module "><a href="../../scid/internal/calculus/integrate_qk.html">integrate_qk</a></div></li><li><div class="module "><a href="../../scid/internal/calculus/integrate_qng.html">integrate_qng</a></div></li></ul></li></ul></li><li class="tree-view collapsed"><div class="package ">ports</div><ul class="tree-view"><li class="tree-view collapsed"><div class="package ">intde</div><ul class="tree-view"><li><div class="module "><a href="../../scid/ports/intde/intde1.html">intde1</a></div></li><li><div class="module "><a href="../../scid/ports/intde/intde2.html">intde2</a></div></li></ul></li><li class="tree-view collapsed"><div class="package ">linpack</div><ul class="tree-view"><li><div class="module "><a href="../../scid/ports/linpack/gtsl.html">gtsl</a></div></li></ul></li><li class="tree-view collapsed"><div class="package ">minpack</div><ul class="tree-view"><li><div class="module "><a href="../../scid/ports/minpack/dogleg.html">dogleg</a></div></li><li><div class="module "><a href="../../scid/ports/minpack/enorm.html">enorm</a></div></li><li><div class="module "><a href="../../scid/ports/minpack/fdjac1.html">fdjac1</a></div></li><li><div class="module "><a href="../../scid/ports/minpack/hybrd.html">hybrd</a></div></li><li><div class="module "><a href="../../scid/ports/minpack/qform.html">qform</a></div></li><li><div class="module "><a href="../../scid/ports/minpack/qrfac.html">qrfac</a></div></li><li><div class="module "><a href="../../scid/ports/minpack/r1mpyq.html">r1mpyq</a></div></li><li><div class="module "><a href="../../scid/ports/minpack/r1updt.html">r1updt</a></div></li></ul></li><li class="tree-view collapsed"><div class="package ">napack</div><ul class="tree-view"><li><div class="module "><a href="../../scid/ports/napack/addchg.html">addchg</a></div></li><li><div class="module "><a href="../../scid/ports/napack/quasi.html">quasi</a></div></li><li><div class="module "><a href="../../scid/ports/napack/stopit.html">stopit</a></div></li></ul></li><li class="tree-view collapsed"><div class="package ">quadpack</div><ul class="tree-view"><li><div class="module "><a href="../../scid/ports/quadpack/qag.html">qag</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qage.html">qage</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qagi.html">qagi</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qagie.html">qagie</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qagp.html">qagp</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qagpe.html">qagpe</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qags.html">qags</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qagse.html">qagse</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qawc.html">qawc</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qawce.html">qawce</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qawf.html">qawf</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qawfe.html">qawfe</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qawo.html">qawo</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qawoe.html">qawoe</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qaws.html">qaws</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qawse.html">qawse</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qc25c.html">qc25c</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qc25f.html">qc25f</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qc25s.html">qc25s</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qcheb.html">qcheb</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qelg.html">qelg</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qk15.html">qk15</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qk15i.html">qk15i</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qk15w.html">qk15w</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qk21.html">qk21</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qk31.html">qk31</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qk41.html">qk41</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qk51.html">qk51</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qk61.html">qk61</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qmomo.html">qmomo</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qng.html">qng</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qpsrt.html">qpsrt</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qwgtc.html">qwgtc</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qwgtf.html">qwgtf</a></div></li><li><div class="module "><a href="../../scid/ports/quadpack/qwgts.html">qwgts</a></div></li></ul></li></ul></li><li><div class="module "><a href="../../scid/calculus.html">calculus</a></div></li><li><div class="module "><a href="../../scid/constants.html">constants</a></div></li><li><div class="module "><a href="../../scid/functions.html">functions</a></div></li><li><div class="module "><a href="../../scid/linalg.html">linalg</a></div></li><li><div class="module "><a href="../../scid/matrix.html">matrix</a></div></li><li><div class="module selected"><a href="../../scid/nonlinear.html">nonlinear</a></div></li><li><div class="module "><a href="../../scid/types.html">types</a></div></li><li><div class="module "><a href="../../scid/util.html">util</a></div></li></ul></li></ul></nav><div id="main-contents"><h1>Function bracketRoot</h1><p>Bracket a root of the function f.
</p><div class="prototype"><code class="lang-d"><div class="single-prototype">
<a href="../../scid/nonlinear/RootBracket.html"><span class="typ">RootBracket</span></a>!(T,ReturnType!F) <span class="pln">bracketRoot</span>(F, T)
<span class="pun">(</span>
<br/>
&nbsp;&nbsp;<span class="kwd">scope </span><span class="pln">F</span> <span class="pln">f</span><span class="pun">,</span>
<br/>
&nbsp;&nbsp;<span class="kwd">in </span><span class="pln">T</span> <span class="pln">x0</span><span class="pun">,</span>
<br/>
&nbsp;&nbsp;<span class="kwd">in </span><span class="pln">T</span> <span class="pln">scale</span><span class="pun">,</span>
<br/>
&nbsp;&nbsp;<span class="kwd">in </span><span class="pln">T</span> <span class="pln">xMin</span> <span class="pun">=</span> <span class="pun">-</span><span class="pln">T<wbr/></span><span class="pun">.</span><span class="pln">infinity</span><span class="pun">,</span>
<br/>
&nbsp;&nbsp;<span class="kwd">in </span><span class="pln">T</span> <span class="pln">xMax</span> <span class="pun">=</span> <span class="pln">T<wbr/></span><span class="pun">.</span><span class="pln">infinity</span>
<br/>
<span class="pun">)</span>
<br/>
<span class="kwd">if</span> <span class="pun">(</span><span class="pln">isFloatingPoint</span><span class="pun">!</span><span class="pln">T </span><span class="pun">&amp;&amp; </span><span class="pln">isUnaryFunction</span><span class="pun">!(</span><span class="pln">F</span><span class="pun">, </span><span class="pln">T</span><span class="pun">)</span><span class="pun">);</span></div></code></div><section><p>If a function f(x) is continuous on an interval [x1,x2],
    and f(x1) and f(x2) have opposite sign, we know the function
    must pass through zero somewhere in the interval.
    The points x1 and x2 are then said to 'bracket' the
    root.  This is usually the first step in locating the root
    of a function.
</p>

<p>    If this function succeeds, it returns a RootBracket containing
    the points x1 and x2, together with the function values f(x1)
    and f(x2).  If it fails, an exception is thrown.
    Note that this library considers the points to be bracketing
    a root also if the root is located exactly at x1 and/or x2,
    i.e. if f(x1)=0 and/or f(x2)=0.
</p>
</section>

<section><h2>Details</h2>
<p>This function will start by evaluating f(x) in the points
    x0 and x0+scale and see if those
    points bracket a root of the given function.  If not, the interval
    is expanded geometrically (i.e. the distance between the points
    is multiplied by a constant factor), always in the direction where
    f(x) is smallest, until the points bracket a root.
</p>

<p>    You may optionally specify a limiting interval [xMin, xMax], and the
    algorithm will never search outside it.  This is useful,
    for instance, for functions that are only defined for certain
    values of x.  If you do specify such an interval, the
    initial point x0 must lie inside it.
</p>

<p>    It is usually worthwhile analysing the behaviour of the function
    in order to find appropriate values for x0 and scale.
    The closer x0 is to the actual root, the fewer steps (i.e. the
    fewer evaluations of f) this algorithm will require to succeed.
    If scale is too large, and the function has several roots,
    there is a chance that it will just step across both roots
    and not find any of them.  On the other hand, if it is too small,
    it may again cause the algorithm to take more steps than would
    otherwise be necessary.
</p>
</section>

<footer><table class="license-info"><tr><th>Authors</th><td><p>Lars Tandle Kyllingstad
</p>
</td></tr><tr><th>Copyright</th><td><p>Copyright (c) 2009-2010, Lars T. Kyllingstad. All rights reserved.
</p>
</td></tr><tr><th>License</th><td><p>Boost License 1.0
</p>
</td></tr></table><p class="faint">Generated using the DDOX documentation generator</p></footer></div></body></html>